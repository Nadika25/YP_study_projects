# Задача
**Задача:** разработать демонстрационную версию поиска изображений по запросу.

**Ход работы:**
* Исследовательский анализ данных;
* Проверка данных;
* Векторизация;
* Обучение модели;
* Тестирование.

# Исследовательский анализ данных
Импортировала необходимые библиотеки, построила функции для визуализации данных, задала константы, загрузла данные и проанализировала их: вывела несколько строк, изображений и основную информацию о датасетах, посмотрела на уникальные значения в столбцах, проверила данные на пропуски и дубликаты. Для дальнейшей работы сформировала единый датасет с единой оценкой.
# Проверка данных
По просьбе заказчика, учла, что некоторые страны, в которых работает компания, есть закон, запрещающий выкладывать информацию о детях (до 16 лет). Создала словарь слов, которые могли бы указывать на наличие ребёнка на изображении. Прописала функцию, определяющую, что в описании присутствует слово из данного словаря. Исключила изображения с детьми из сформированного на прошлом этапе датасета. 
# Векторизация
Отобрала уникальные изображения и описания. Для векторизации изображений воспользовалась архитектурой **ResNet-18**. Для векторизации текста загрузила предобученную модель **BERT**. Полученные на выходе датафреймы объединила.
# Обучение модели
Датасет разделила на обучающую и валидационную выборки в соотношении 80% на 20%. Чтобы исключить попадание изображения  и в обучающую, и в тестовую выборки воспользовалась классом **GroupShuffleSplit**. Целевой признак **mark** вынесла в отдельные датафреймы.
В качестве обучения исследовала две модели:
* **Линейная регрессия**
* **Полносвязная нейронная сеть**
  
В качестве метрики взяла **RMSE**. Это позволило ускорить процесс обучения нейронной сети.
Значение метрики RMSE гораздо лучше оказалось после обучения на нейронной сети.
# Тестирование
Тестовые данные тестировала на построенной нейронной сети. Выбрала случайные 10 запросов и для каждого запроса получила наиболее релевантное изображение. В целом, модель улавливает общую суть: если на изображении есть собака, то выведет собаку, если спорт, то будет нам спорт. Однако контекст модель пока понимать не научилась. Для улучшения модели можно попробовать увеличить количество слоёв и эпох. Возможно, попробовать какую-нибудь предобученную модель. Если демонстрационная модель будет утверждена, то для дальнейшей работы необходимо увеличить мощности применяемого оборудования.
